<!doctype html>
<html {% if section %} data-current="{{ section }}"{% endif %} lang="en">

	{% include "components/head.njk" %}

		<style>
			main {
				display:grid;
				align-items: center;
				grid-gap: 1rem;
  				grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
			}
			.card {	
				min-height : 10rem;	
				padding: 20px;
				background-color: #fff;
				border: 0;
				box-shadow:
				0 2.8px 2.2px rgba(0, 0, 0, 0.034),
				0 6.7px 5.3px rgba(0, 0, 0, 0.048),
				0 12.5px 10px rgba(0, 0, 0, 0.06),
				0 22.3px 17.9px rgba(0, 0, 0, 0.072),
				0 41.8px 33.4px rgba(0, 0, 0, 0.086),
				0 10px 10px rgba(0, 0, 0, 0.1)
				;
			}
			.result-item {
				color: #2c4361;
				font-size: .9em;
				margin: 1rem 0;
			}

			.result-item:first-child  {
				font-size: .7em;
				color: #0457c4;
			}
		</style>

	<body>

		<header>
			<img class="brand-logo" src="/_includes/assets/img/brand-logo-2.svg"/>
			{% include "components/nav.njk" %}
		</header>

		<main>

		</main>

		<script>
		    let side_fields = ["Date","Location","Collected by","Microplastics concentration (Number of microplastics / Filtered water volume)"];

			let headerRow = "1";
            let currRow = "1";
            let headerFields = [];

			fetch("https://spreadsheets.google.com/feeds/cells/15tngdLyCqm_wzF9Jv2za4DdGLxPyOf9BHtVwlEIK-J0/1/public/full?alt=json")
            .then(res => res.json())
            .then(data => {
				let main = document.querySelector("main");
				let card = document.createElement("div");
				data.feed.entry.forEach((item,i) => {       
					if(item["gs$cell"]["row"] == headerRow)                                        
                        headerFields.push(item["gs$cell"]["inputValue"])                                
                    else
                    {
                        if(item["gs$cell"]["row"] != currRow)
                        {   
                            currRow = item["gs$cell"]["row"];             
							card = document.createElement("div");
							card.classList.add("card");
							main.append(card);
						}

						if(side_fields.indexOf(headerFields[parseInt(item["gs$cell"]["col"])-1]) != -1)
                        	card.innerHTML += `<p class="result-item">${item["gs$cell"]["inputValue"]}</p>`;
					}
				});                
			});
		</script>

		{% include "components/footer.njk" %}

	</body>

</html>